{% extends 'base.html' %}
{% load url from future %}

{% block title %}Home{% endblock %}

{% block base_content %}
<h1>home</h1>
<div class="row userhome">
{% for item in test_data %}
<div class="span8 testpanel">
<h4>Practice Test {{ forloop.counter }}</h4>
<div class="tp_content">
    {% if item.sittings.0 %}
    <span class="span2 pull-left">
    <strong>last sitting results</strong>
    </span>
    <span class="scaled pull-left">{{ item.sittings.0.score_scaled }}</span>
    <span class="score">{{ item.sittings.0.score }} / {{ item.sittings.0.test.question_set.count }}</span><br />
    <span class="percent">{{item.sittings.0.score_percent }}</span><br />
    <span class="timesince pull-right"><strong>{{ item.sittings.0.created_date|timesince }} ago</strong></span><br />
    {% endif %}
    {% if item.sittings.count == 0 %}
    <span class="notattempted">Not yet attempted.</span>
    {% elif item.sittings.count > 1 %}
    <div id="tp_history{{ forloop.counter }}" class="collapse">
    {% for sitting in item.sittings %}
        {% if sitting != item.sittings.0 %}
        Prior Attempt: ({{ sitting.score_scaled }}) {{ sitting.created_date|timesince }}<br />
        {% endif %}
    {% endfor %}
    </div>
    <button type="button" class="btn" data-toggle="collapse" data-target="#tp_history{{ forloop.counter }}">history</button>
    {% endif %}
    <div class="newsitting"><a href="{% url 'sitting_new' forloop.counter %}">new sitting</a></div>
</div>
 </div>
{% endfor %}
</div>

{% endblock %}
